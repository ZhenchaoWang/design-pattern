> 英文名称：Immutable

所谓不变模式，就是说一个对象在其被创建之后其状态就不再发生变化，该对象可以被多个对象共享，从而减少并发访问加锁的开销。在设计类的时候，除非其对象状态有变化的必要，否则都应该设计成不变模式。

不变模式分为 __弱不变模式__ 和 __强不变模式__。

### 一. 弱不变模式

在弱不变模式中，一个类对象的状态是不可以被改变的，但是这个类的子类的对象可以具备变化的状态。

符合弱不变模式的类，在实现上需要满足如下特点：

1. 类没有任何方法可以修改对象的状态，从而当对象被构造出来之后，便不能再被改变。

2. 所有的属性都是私有的，不声明任何公开的属性。

3. 如果该类的对象引用了可变对象，则需要保证这些可变对象不能被外界访问。如果可以的话，就尽量在不变对象内部实例化这些可变对象，如果不得以非要由构造函数参数传入，则应该在构造不变对象时，复制一份对应的可变对象。

__弱不变模式的缺点：__

1. 弱不变对象的子对象可以是可变的。

2. 可变子对象可以修改父不变对象的状态，从而间接让外界修改该不变对象的状态。

### 二. 强不变模式

符合强不变模式的类，不光其自身对象不可变，而且其子类对象也是不可变的。

在实现上，强不变模式的类不光要满足弱不变模式需要满足的 3 点，还要满足下列要求：

1. 所有的方法都是`final`，确保不会被覆盖

2. 类本身也是`final`类型的，这样就不可以被继承

举例说明：

```java
/**
 * 强不变类
 *
 * @author zhenchao.wang 2017-04-15 22:21
 * @version 1.0.0
 */
public final class ImmutableClass {  // 类应该用final修饰，防止被继承

    /** 所有的属性都应该设置为私有 */

    private Integer a;

    private Double b;

    private String c;

    /**
     * 通过构造方法来实例化对象
     * 如果传入的对象是可变的，则需要复制一份
     *
     * @param a
     * @param b
     * @param c
     */
    public ImmutableClass(Integer a, Double b, String c) {
        this.a = a;
        this.b = b;
        this.c = c;
    }

    /** 所有的方法都需要加 final 修饰 */

    public final Integer getA() {
        return a;
    }

    public final Double getB() {
        return b;
    }

    public final String getC() {
        return c;
    }
}
```

### 三. 不变模式的优缺点

__不变模式的优点：__

1. 因为不可变，所以对象更加容易维护

2. 因为不可变，所以不变对象是线程安全的

__不变模式的缺点：__

如果需要修改一个不变对象，就只能通过创建新的对象来达到目的，这样在需要频繁修改的场景下，就会创建大量对象，不推荐在 `for` 循环中用 `+` 去拼接字符串就是这一考虑。